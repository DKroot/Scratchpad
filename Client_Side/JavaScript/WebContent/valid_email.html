<!-- This script has been in the http://www.javascripts.com Javascript Public Library! -->
<!-- Note that though this material may have been in a public depository, certain author copyright restrictions may apply. -->
<html>
<head>
<title>Validating Email Addresses: Version 2 - by Vincent Puglia GrassBlade</title>
<script language="javascript">

var chkDot = true;
var usEmail = true;
function validEmail(eAddr) 
{ 
   var lenSuffix = (usEmail) ? 4: 3;
   var goodAddr = false;
   var ndxAt = ndxDot = 0;

   ndxAt  = eAddr.indexOf("@");
   ndxDot = eAddr.indexOf(".");
   ndxDot2 = eAddr.lastIndexOf(".");

   if ( (ndxDot < 0) || (ndxAt < 0) )
      alert("Your email address lacks '.' or '@'.\n\nThe format is 'you@dom.suf'");  
   else if (chkDot && (ndxDot < ndxAt) )
        chkDot =!( confirm("You entered a 'dot' before the '@'\n Are you sure that is right?"));
   else if ( (ndxDot2 - 3) <= ndxAt)
        alert("You may be missing your domain name.\n\nThe format is 'you@dom.suf'");
   else if ( eAddr.length < (ndxDot2 + lenSuffix) )
      usEmail =!( confirm("You have fewer than 3 characters as a domain suffix.\nAre you sure that is right?"));
   else
      goodAddr = true;

   return (goodAddr);                       
} 
</script>
</head>

<body> 
<p>&nbsp;</p>
<form>
 <p align="center"><font color="#000000"
  face="Arial Bold">Enter email 
  <input type="text"
     size="25" name="email"
     onblur="if(!validEmail(this.value)) this.focus();"> 
  <input type="text"
   size="25" name="email2"
   onblur="if(!validEmail(this.value)) this.focus();">    </font></p>
</form>

<p align="left"><font color="#000000" face="Arial Bold">The
validation routine, which performs four checks, is triggered by
an onBlur() event handler and returns focus to the text field if
an error is found. The error checking has been expanded to accept
"fname.lname@123.123" and non-USA email "name@dom.xx.xx" addresses.</font></p>

<p align="left"><font color="#000000" face="Arial Bold">If you
have any problems, contact me at: </font><a
href="http://www.javascripts.com/repository/mailto:grassblad@aol.com"><font color="#000000"
face="Arial Bold">grassblad@aol.com</font></a><font
color="#000000" face="Arial Bold"> or download the complete
explanation at: </font><a href="http://members.aol.com/grassblad"><font
color="#000000" face="Arial Bold">GrassBlade</font></a></p>


<br>

</body>
</html>
        
<!-- Simba says Roar. -->



