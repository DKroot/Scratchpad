<!-- This script has been in the http://www.javascripts.com Javascript Public Library! -->
<!-- Note that though this material may have been in a public depository, certain author copyright restrictions may apply. -->
<html>

<script Language="JavaScript">
<!--
function testKey(e){
   chars= "0123456789/";
   e    = window.event;
   if(chars.indexOf(String.fromCharCode(e.keyCode))==-1) window.event.keyCode=0;
};

function valDate(M, D, Y){
  var Months = new Array(31,28,31,30,31,30,31,31,30,31,30,31);
  Leap  = false;

  if((Y % 4 == 0) && ((Y % 100 != 0) || (Y %400 == 0)))
    Leap = true;
  if((D < 1) || (D > 31) || (M < 1) || (M > 12) || (Y < 0))
    return(false);
  if((D > Months[M-1]) && !((M == 2) && (D > 28)))
    return(false);
  if(!(Leap) && (M == 2) && (D > 28))
    return(false);    
  if((Leap)  && (M == 2) && (D > 29))
    return(false);    
};

function formatDate(dateForm){
   cDate = dateForm.value;
   dSize = cDate.length;
   sCount= 0;
 
   if(cDate=='') return;

   //Check ou the slashs
   for(var i=0; i < dSize; i++)
      (cDate.substr(i,1) == "/") ? sCount++ : sCount;
   if (sCount != 2){
      alert("Date must be in the format\n ''mm/dd/yyyy''");
      dateForm.focus();
      return false;
   };
   //Check if the year is a 2 or 4 digits string
   ySize = cDate.substring(cDate.lastIndexOf("/")+1,dSize).length
   if(ySize<2 || ySize>4 || ySize == 3){
     alert('Invalid Date !');
     dateForm.focus();
     return false;
   };
   //Cut the date string into three parts (Month, Day & Year)
   idxBarI = cDate.indexOf("/");
   idxBarII= cDate.lastIndexOf("/");
   strM    = cDate.substring(0,idxBarI);
   strD    = cDate.substring(idxBarI+1,idxBarII);
   strY    = cDate.substring(idxBarII+1,dSize);

   strM = (strM.length < 2 ? '0'+strM : strM);   
   strD = (strD.length < 2 ? '0'+strD : strD);
   if(strY.length == 2)
      strY = (strY > 50  ? '19'+strY : '20'+strY);
   dateForm.value = strM+'/'+strD+'/'+strY;
 
   ok = valDate(strM, strD, strY);
    if(ok==false){ 
      alert("Invalid Date!");
      dateForm.focus();
      return false;
   };
};


-->
</script>

<style>
    a       { text-decoration: none; font-weight: blue }
    a:hover { text-decoration: underline }
</style>

<body onLoad="javascript:document.Form1.Date.focus()">

<form name="Form1" method=get onSubmit="return false">
<center>
<font face=tahoma,arial size=2>Enter the Date</font>
<table width=10% bgcolor=white border=0 cellpadding=5 cellspacing=5>
<td align=center>
Field 1:
<input type=text maxlength=10 name="Date" size=10 onBlur="return formatDate(this)" onKeyPress="testKey(event)" value="">
Field 2:
<input type=text maxlength=10 name="Date2" size=10 onBlur="return formatDate(this)" onKeyPress="testKey(event)" value="">
</td>
</table>

</form>
<font face=tahoma,arial size=2>Comments and Sugestions<br><a href="http://www.javascripts.com/repository/mailto:arley@pobox.com">arley@pobox.com</font></a>

</body>
</html>
<!-- Simba says Roar. -->
